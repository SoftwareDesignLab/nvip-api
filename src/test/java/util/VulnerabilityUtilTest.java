package util;

import jakarta.persistence.EntityManager;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Nested;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.nvip.entities.Cvss;
import org.nvip.entities.Vulnerability;
import org.nvip.util.VulnerabilityUtil;

import static org.junit.jupiter.api.Assertions.*;

@ExtendWith(MockitoExtension.class)
public class VulnerabilityUtilTest {

    @InjectMocks VulnerabilityUtil vulnerabilityUtil;

    @Nested
    class ParseCvssScoreListTest {

        @Test
        void testParseCvssScoreListWithEmptyLists(){
            Vulnerability cve = new Vulnerability();
            cve.setCveId("CVE-1234-5678");
            String[] baseSeverityArr = new String[]{};
            String[] impactScoreArr = new String[]{};


            //TODO: Fix this test
//            Cvss[] cvssScore = vulnerabilityUtil.parseCvssScoreList(
//                    cve,
//                    baseSeverityArr,
//                    impactScoreArr
//            );

//            assertEquals(0, cvssScore.length);
        }
    }
}