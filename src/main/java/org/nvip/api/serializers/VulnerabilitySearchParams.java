package org.nvip.api.serializers;

import com.fasterxml.jackson.annotation.JsonFormat;
import com.fasterxml.jackson.annotation.JsonProperty;
import lombok.Data;
import org.springframework.boot.jackson.JsonComponent;

import java.time.LocalDate;

@Data
@JsonComponent
public class VulnerabilitySearchParams {

    String keyword;

    @JsonFormat(
            shape = JsonFormat.Shape.STRING,
            pattern = "dd-MM-yyyy hh:mm:ss")
    LocalDate startDate;

    @JsonFormat(
            shape = JsonFormat.Shape.STRING,
            pattern = "dd-MM-yyyy hh:mm:ss")
    LocalDate endDate;

    String[] cvssScores;
    String[] vdoLabels;
    int limitCount;
    String product;

    @JsonProperty
    public void setCvssScores(String cvssScores){
        this.cvssScores = cvssScores.split(";");
    }
}
