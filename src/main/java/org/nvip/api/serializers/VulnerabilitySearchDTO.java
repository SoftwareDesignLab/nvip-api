package org.nvip.api.serializers;

import lombok.Builder;
import lombok.Getter;
import lombok.Setter;
import lombok.Singular;
import org.nvip.entities.PatchCommit;
import org.nvip.entities.RawDescription;

import java.util.List;

@Getter
@Setter
@Builder
public class VulnerabilitySearchDTO {

    int vulnId;
    String cveId;
    String description;
    DescriptionDTO altDescription;
    String patch;
    String introducedDate;
    String publishedDate;
    String createdDate;
    String lastModifiedDate;
    String fixedDate;
    CvssDTO cvssScore;
    @Builder.Default boolean existInMitre = true;
    @Builder.Default boolean existInNvd = true;
    @Builder.Default Integer timeGapNvd = 0;
    @Builder.Default Integer timeGapMitre = 0;

    @Builder.Default String status = "Under Review";
    @Builder.Default String type = "N/A"; // set vulnerability type (based on impact method?)
    @Builder.Default String discoveredBy = "N/A"; // Use CNA and/or other sources
    @Builder.Default String domain = "N/A"; // assign domain based on CPE
    @Builder.Default String exploitPublishDate = "N/A";
    @Builder.Default String exploitUrl = "N/A";

    @Singular(value = "characteristic")
    List<VdoCharacteristicDTO> vdoList;

    @Singular(value = "source")
    List<RawDescriptionDTO> sources;

    @Singular(value = "product")
    List<ProductDTO> products;

    @Singular(value = "cpe")
    List<String> cpes;

    @Singular(value = "patchCommit")
    List<PatchCommitDTO> patchCommits;

    @Singular(value = "patchDescription")
    List<String> patchDescriptions;
}
