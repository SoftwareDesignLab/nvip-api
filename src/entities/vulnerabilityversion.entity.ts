import {
    Entity,
    PrimaryGeneratedColumn,
    ManyToOne,
    OneToOne,
    JoinColumn,
    Column,
    CreateDateColumn,
} from 'typeorm';
import { Vulnerability } from './vulnerability.entity'; // Assuming you have this entity
import { VdoSet } from './vdoset.entity'; // Assuming you have this entity
import { CpeSet } from './cpeset.entity'; // Assuming you have this entity
import { Description } from './description.entity'; // Assuming you have this entity

@Entity({ name: 'vulnerabilityversion' })
export class VulnerabilityVersion {
    @PrimaryGeneratedColumn({ name: 'vuln_version_id' })
    vulnerabilityVersionId: number;

    @ManyToOne(
        () => Vulnerability,
        (vulnerability) => vulnerability.vulnerabilityVersions,
    )
    @JoinColumn({ name: 'cve_id', referencedColumnName: 'cveId' })
    vulnerability: Vulnerability;

    @OneToOne(() => VdoSet)
    @JoinColumn({ name: 'vdo_set_id', referencedColumnName: 'vdoSetId' })
    vdoSet: VdoSet;

    @OneToOne(() => CpeSet)
    @JoinColumn({ name: 'cpe_set_id', referencedColumnName: 'cpeSetId' })
    cpeSet: CpeSet;

    @OneToOne(() => Description, (description) => description.vulnerabilityVersion)
    @JoinColumn({ name: 'description_id', referencedColumnName: 'descriptionId' })
    description: Description;

    @CreateDateColumn()
    createdDate: Date;

    @Column()
    publishedDate: Date;

    @Column()
    lastModifiedDate: Date;

    @Column({ nullable: true })
    userId: number | null;
}
