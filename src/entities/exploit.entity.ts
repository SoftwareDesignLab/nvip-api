import {
    Entity,
    PrimaryGeneratedColumn,
    Column,
    ManyToOne,
    JoinColumn,
    CreateDateColumn,
} from 'typeorm';
import { Vulnerability } from './vulnerability.entity';

@Entity()
export class Exploit {
    @PrimaryGeneratedColumn()
    id: number;

    @Column()
    name: string;

    @Column({ type: 'text' })
    description: string;

    @Column()
    exampleFile: string;

    @Column()
    author: string;

    @CreateDateColumn({ name: 'date_published' })
    datePublished: Date;

    @Column({ name: 'is_repo' })
    isRepo: boolean;

    @Column()
    source: string;

    @Column()
    dateCreated: string;

    @Column({ name: 'download_failed' })
    downloadFailed: boolean;

    @ManyToOne(() => Vulnerability, (vulnerability) => vulnerability.exploits)
    @JoinColumn({ name: 'cve_id' , referencedColumnName: 'cveId'})
    vulnerability: Vulnerability;

    @Column()
    sourceUrl: string;

    @Column({ name: 'ignore' })
    ignore: boolean;

    @Column({ name: 'fixed' })
    fixed: boolean;
}
